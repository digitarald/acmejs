// Generated by CoffeeScript 1.6.1
var Component, Pool, Vec2, Wander,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Component = require('./component');

Pool = require('./pool');

Vec2 = require('./math').Vec2;

Wander = (function(_super) {
  var acc, center, force;

  __extends(Wander, _super);

  function Wander() {
    return Wander.__super__.constructor.apply(this, arguments);
  }

  Wander.prototype.tag = 'wander';

  Wander.prototype.attributes = {
    distance: 50,
    radius: 25,
    change: 1,
    angle: 0
  };

  Wander.prototype.instantiate = function(attributes) {
    this.distance = attributes.distance, this.radius = attributes.radius, this.change = attributes.change, this.angle = attributes.angle;
    return this;
  };

  center = Vec2();

  force = Vec2();

  acc = Vec2();

  Wander.prototype.fixedUpdate = function(dt) {
    Vec2.norm(this.kinetic.vel, center, this.distance);
    Vec2.rot(Vec2.set(force, this.radius, 0), this.angle);
    this.angle += Math.random() * this.change - this.change * 0.5;
    Vec2.add(center, force, acc);
    this.kinetic.applyImpulse(acc);
    return this;
  };

  return Wander;

})(Component);

new Pool(Wander);

module.exports = Wander;

// Generated by CoffeeScript 1.3.3
var MAX_SPEED, World, current, dir, origin, pos;

MAX_SPEED = 150;

origin = Vec2();

current = Vec2();

pos = Vec2();

dir = Vec2();

World = (function() {

  function World(renderer) {
    this.renderer = renderer;
    this.updateQueue = [Collider.pool, Pool.borders, Pool.boids, Firework.pool, Particle.pool];
    this.drawQueue = [Particle.pool];
    this.pubsub = Pubsub.pool.alloc(this);
    this.firework = Firework.pool.alloc(this, Vec2(0, 0), Vec2(800, 450), Vec2(20, 20), Vec2(5, 10), Vec2(300, 300), 0.03);
    this.steps = 0;
    this.minStep = 100 / 6;
    this.gravity = Vec2(0, 0);
    this.friction = 10;
    this.drag = 1;
  }

  World.prototype.update = function(dt) {
    var instance, min, _i, _len, _ref, _results;
    if (dt > 500) {
      dt = 100;
    }
    this.steps += dt;
    min = this.minStep;
    _results = [];
    while (this.steps > min) {
      this.steps -= min;
      _ref = this.updateQueue;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        instance = _ref[_i];
        instance.update(min, this);
      }
      _results.push(this);
    }
    return _results;
  };

  World.prototype.draw = function(context) {
    var instance, _i, _len, _ref;
    _ref = this.drawQueue;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      instance = _ref[_i];
      instance.draw(context, this);
    }
    return this;
  };

  return World;

})();
